<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>RAPPORT STATISTIQUE - HOTEL LE PRESTIGE</title>
    <style>
        /* Style optimisé pour la lecture sur papier et photocopie */
        body { 
            font-family: Arial, sans-serif; 
            background: white; 
            color: black; 
            margin: 0; 
            padding: 10px; 
            font-size: 14px; 
        }
        .container { 
            max-width: 850px; 
            margin: auto; 
            border: 2px solid black; 
            padding: 20px; 
        }
        
        .header { 
            text-align: center; 
            border-bottom: 3px solid black; 
            margin-bottom: 20px; 
            padding-bottom: 10px;
        }
        .header h1 { 
            margin: 0; 
            font-size: 22px; 
            text-transform: uppercase; 
            font-weight: bold;
        }

        .section-title { 
            background: black; 
            color: white; 
            padding: 8px; 
            font-size: 14px; 
            text-transform: uppercase; 
            margin-top: 15px; 
            font-weight: bold;
            -webkit-print-color-adjust: exact;
        }
        
        .info-row { 
            display: flex; 
            border: 1px solid black;
            border-top: none;
        }
        .info-item { 
            flex: 1; 
            border-right: 1px solid black; 
            padding: 10px;
            text-align: center;
        }
        .info-item:last-child { border-right: none; }
        
        .label { 
            font-size: 11px; 
            font-weight: bold; 
            text-transform: uppercase; 
            display: block; 
            margin-bottom: 5px;
        }
        .value { 
            font-size: 18px; 
            font-weight: 900; 
            display: block; 
        }

        .tables-container { 
            display: flex; 
            gap: 20px; 
            margin-top: 10px; 
        }
        .table-half { flex: 1; }
        table { 
            width: 100%; 
            border-collapse: collapse; 
        }
        th { 
            text-align: left; 
            font-size: 12px; 
            border-bottom: 2px solid black; 
            padding: 8px 5px; 
        }
        td { 
            padding: 8px 5px; 
            border-bottom: 1px solid black; 
            font-weight: bold;
        }
        
        .footer { 
            margin-top: 20px; 
            font-size: 11px; 
            text-align: center; 
            font-style: italic;
        }

        /* Styles pour les éléments qui ne doivent pas être imprimés */
        .no-print {
            display: block;
            width: 100%;
            padding: 10px;
            background: #444;
            color: white;
            text-align: center;
            text-decoration: none;
            margin-bottom: 10px;
            border-radius: 5px;
            font-weight: bold;
            border: none;
        }

        .filter-box {
            background: #f4f4f4;
            padding: 15px;
            border: 1px solid #ccc;
            margin-bottom: 20px;
            text-align: center;
        }

        select, button {
            padding: 8px;
            font-size: 14px;
            font-weight: bold;
        }

        @media print {
            .no-print, .filter-box { display: none; }
            .container { border: 2px solid black; }
            body { padding: 0; }
        }
    </style>
</head>
<body>

<a href="{{ url_for('dashboard') }}" class="no-print">RETOUR AU DASHBOARD</a>

<div class="filter-box no-print">
    <form action="{{ url_for('stats') }}" method="get">
        <label><strong>CONSULTER LES ARCHIVES : </strong></label>
        <select name="mois">
            <option value="1" {% if stats.mois_num == 1 %}selected{% endif %}>Janvier</option>
            <option value="2" {% if stats.mois_num == 2 %}selected{% endif %}>Février</option>
            <option value="3" {% if stats.mois_num == 3 %}selected{% endif %}>Mars</option>
            <option value="4" {% if stats.mois_num == 4 %}selected{% endif %}>Avril</option>
            <option value="5" {% if stats.mois_num == 5 %}selected{% endif %}>Mai</option>
            <option value="6" {% if stats.mois_num == 6 %}selected{% endif %}>Juin</option>
            <option value="7" {% if stats.mois_num == 7 %}selected{% endif %}>Juillet</option>
            <option value="8" {% if stats.mois_num == 8 %}selected{% endif %}>Août</option>
            <option value="9" {% if stats.mois_num == 9 %}selected{% endif %}>Septembre</option>
            <option value="10" {% if stats.mois_num == 10 %}selected{% endif %}>Octobre</option>
            <option value="11" {% if stats.mois_num == 11 %}selected{% endif %}>Novembre</option>
            <option value="12" {% if stats.mois_num == 12 %}selected{% endif %}>Décembre</option>
        </select>

        <select name="annee">
            <option value="2025" {% if stats.annee == 2025 %}selected{% endif %}>2025</option>
            <option value="2026" {% if stats.annee == 2026 %}selected{% endif %}>2026</option>
        </select>

        <button type="submit" style="background: black; color: white; cursor: pointer;">AFFICHER LE RAPPORT</button>
    </form>
</div>

<div class="container">
    <div class="header">
        <h1>HOTEL LE PRESTIGE - MARADI</h1>
        <strong>RAPPORT MENSUEL : {{ stats.mois_nom }} {{ stats.annee }}</strong>
    </div>

    <div class="section-title">Ressources Humaines & Capacité</div>
    <div class="info-row">
        <div class="info-item"><span class="label">Emp. Permanent</span><span class="value">00</span></div>
        <div class="info-item"><span class="label">Emp. Temporaire</span><span class="value">06</span></div>
        <div class="info-item"><span class="label">Chambres Offertes</span><span class="value">09</span></div>
        <div class="info-item"><span class="label">Chambres Occupées</span><span class="value">09</span></div>
    </div>

    <div class="section-title">Fréquentation du mois ({{ stats.mois_nom }})</div>
    <div class="info-row">
        <div class="info-item"><span class="label">Du 1 au 20</span><span class="value">{{ stats.debut_mois }}</span></div>
        <div class="info-item"><span class="label">Du 21 au {{ stats.nb_jours_mois }}</span><span class="value">{{ stats.fin_mois }}</span></div>
        <div class="info-item"><span class="label">Total Nuitées</span><span class="value">{{ stats.total_nuitees }}</span></div>
    </div>

    <div class="section-title">Indicateurs de Performance</div>
    <div class="info-row">
        <div class="info-item" style="flex: 2;">
            <span class="label">Chiffre d'Affaires Mensuel (FCFA)</span>
            <span class="value">{{ "{:,.0f}".format(stats.chiffre_affaires).replace(',', ' ') }}</span>
        </div>
        <div class="info-item">
            <span class="label">Taux d'Occupation</span>
            <span class="value">{{ stats.taux_occupation }} %</span>
        </div>
    </div>

    <div class="tables-container">
        <div class="table-half">
            <div class="section-title">Nationalités</div>
            <table>
                <thead><tr><th>PAYS</th><th>EFF.</th></tr></thead>
                <tbody>
                    {% for n, c in stats.nationalites.items() %}
                    <tr><td>{{ n }}</td><td>{{ c }}</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="table-half">
            <div class="section-title">Provenances</div>
            <table>
                <thead><tr><th>ORIGINE</th><th>EFF.</th></tr></thead>
                <tbody>
                    {% for p, c in stats.provenances.items() %}
                    <tr><td>{{ p }}</td><td>{{ c }}</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <div class="footer">
        Rapport généré le : {{ datetime_now }} - Hôtel Le Prestige, Maradi
    </div>
</div>

<button class="no-print" style="margin-top:20px; cursor:pointer;" onclick="window.print()">CLIQUEZ ICI POUR IMPRIMER CE RAPPORT</button>

</body>
</html>